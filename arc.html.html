<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adaptive Ray Skipping for Radiance Cascades</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --bg: #fff;
            --text: #333;
            --border: #ddd;
        }
        
        * { box-sizing: border-box; }
        
        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 1.7;
            color: var(--text);
            background: var(--bg);
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        h1 {
            font-size: 2em;
            text-align: center;
            margin-bottom: 0.5em;
            color: var(--primary);
        }
        
        .author {
            text-align: center;
            font-style: italic;
            color: #666;
            margin-bottom: 2em;
        }
        
        h2 {
            font-size: 1.5em;
            color: var(--primary);
            border-bottom: 2px solid var(--accent);
            padding-bottom: 0.3em;
            margin-top: 2em;
        }
        
        h3 {
            font-size: 1.2em;
            color: var(--primary);
            margin-top: 1.5em;
        }
        
        .abstract {
            background: #f8f9fa;
            border-left: 4px solid var(--accent);
            padding: 20px;
            margin: 2em 0;
            font-style: italic;
        }
        
        .key-result {
            background: linear-gradient(135deg, #e8f8e8 0%, #d4edda 100%);
            border: 1px solid var(--success);
            border-radius: 8px;
            padding: 15px 20px;
            margin: 1em 0;
        }
        
        .discovery-box {
            background: #fdeaea;
            border: 1px solid var(--danger);
            border-radius: 8px;
            padding: 15px 20px;
            margin: 1em 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1em 0;
            font-size: 0.9em;
        }
        
        th, td {
            border: 1px solid var(--border);
            padding: 10px 12px;
            text-align: left;
        }
        
        th { background: #f8f9fa; font-weight: bold; }
        tr:nth-child(even) { background: #fafafa; }
        .highlight-row { background: #e8f8e8 !important; font-weight: bold; }
        
        code {
            font-family: 'Consolas', 'Monaco', monospace;
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        
        pre {
            background: #2d3436;
            color: #dfe6e9;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85em;
            line-height: 1.5;
        }
        
        pre code { background: none; padding: 0; color: inherit; }
        .comment { color: #74b9ff; }
        .keyword { color: #fd79a8; }
        .function { color: #55efc4; }
        .number { color: #ffeaa7; }
        
        figure {
            margin: 2em 0;
            text-align: center;
        }
        
        figure svg {
            max-width: 100%;
            height: auto;
            border: 1px solid #eee;
            border-radius: 8px;
        }
        
        figcaption {
            font-style: italic;
            color: #666;
            margin-top: 0.5em;
            font-size: 0.9em;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 1.5em 0;
        }
        
        .metric-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            border: 1px solid var(--border);
        }
        
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: var(--accent);
        }
        
        .metric-label { color: #666; font-size: 0.9em; }
        .success { color: var(--success); }
        .danger { color: var(--danger); }
        
        ol, ul { margin: 1em 0; padding-left: 2em; }
        li { margin: 0.5em 0; }
        
        hr { border: none; border-top: 1px solid var(--border); margin: 3em 0; }
        
        .references { font-size: 0.9em; }
        .references p { margin: 0.5em 0; padding-left: 2em; text-indent: -2em; }
        
        footer { text-align: center; color: #999; margin-top: 3em; font-size: 0.9em; }
        
        @media print {
            body { max-width: none; }
            figure { page-break-inside: avoid; }
            h2 { page-break-after: avoid; }
        }
    </style>
</head>
<body>

<h1>Adaptive Ray Skipping for Radiance Cascades</h1>
<p class="author">Emmanuel Botros Youssef<br>Independent Researcher • 2025</p>

<div class="abstract">
    <strong>Abstract:</strong> We present an optimization for Radiance Cascades [Sannikov 2023] that achieves <strong>~19% average ray reduction</strong> while <strong>guaranteeing >50 dB PSNR</strong> (visually identical to baseline) across all 50 tested scenes. Our approach exploits the observation that higher cascade levels are oversampled relative to their actual frequency content.
    <br><br>
    The key contribution is an <strong>adaptive signal selection methodology</strong> validated with statistical rigor: we evaluated six candidate signals and found that frequency bandwidth is <strong>significantly negatively correlated</strong> (r = -0.68, 95% CI [-0.81, -0.50], p < 0.05) with quality tolerance—the opposite of theoretical expectations. Instead, <strong>Mean + StdDev</strong> provides reliable prediction (r = 0.73, 95% CI [0.56, 0.84], p < 0.05).
</div>

<div class="metrics-grid">
    <div class="metric-card">
        <div class="metric-value">n=50</div>
        <div class="metric-label">Scenes Tested</div>
    </div>
    <div class="metric-card">
        <div class="metric-value" style="color: #3498db;">~19%</div>
        <div class="metric-label">Ray Reduction</div>
    </div>
    <div class="metric-card">
        <div class="metric-value success">>50dB</div>
        <div class="metric-label">All Scenes Guaranteed</div>
    </div>
    <div class="metric-card">
        <div class="metric-value" style="color: #9b59b6;">p<0.05</div>
        <div class="metric-label">Statistical Significance</div>
    </div>
</div>

<hr>

<h2>1. Introduction</h2>

<h3>1.1 Background</h3>
<p>Radiance Cascades [Sannikov 2023] is an elegant algorithm for real-time global illumination that achieves O(N) complexity through a multi-scale probe structure. The algorithm traces rays at multiple <em>cascade levels</em>, where each level covers a different distance interval.</p>

<p><strong>Key structure:</strong></p>
<ul>
    <li><strong>Spatial resolution</strong> decreases at higher levels (probes spread further apart)</li>
    <li><strong>Angular resolution</strong> increases at higher levels (more ray directions per probe)</li>
    <li>The 4× angular branching factor maintains constant total rays per level</li>
</ul>

<h3>1.2 The Oversampling Hypothesis</h3>
<p>The 4× branching factor assumes angular frequency content remains high at each level. However, several factors reduce <em>actual</em> frequency content at higher levels:</p>
<ol>
    <li><strong>Inverse-square falloff</strong> attenuates small sources</li>
    <li><strong>Spatial integration</strong> produces smooth distributions</li>
    <li><strong>Environment lighting</strong> is typically smooth</li>
    <li><strong>Multiple scattering</strong> acts as a low-pass filter</li>
</ol>

<h3>1.3 Contributions</h3>
<ol>
    <li><strong>Empirical validation</strong> on 50 diverse scenes</li>
    <li><strong>Statistically significant finding</strong> that bandwidth is negatively correlated (r = -0.68, p < 0.05)</li>
    <li><strong>Mean + StdDev signal</strong> validated as reliable predictor (r = 0.73, p < 0.05)</li>
    <li><strong>Adaptive algorithm</strong> achieving ~19% ray reduction with <strong>guaranteed >50 dB on all scenes</strong></li>
</ol>

<hr>

<h2>2. Related Work</h2>

<h3>2.1 Radiance Cascades</h3>
<p>Radiance Cascades [Sannikov 2023] builds on radiance probes [McGuire et al. 2017]. The key insight is that the branching factor maintains constant ray budget while preserving information through careful merging.</p>

<h3>2.2 Adaptive Sampling</h3>
<p>Adaptive sampling has a long history [Whitted 1980, Mitchell 1987]. Recent work includes neural importance sampling [Müller et al. 2019]. Our approach differs by operating at the cascade level.</p>

<h3>2.3 Frequency Analysis</h3>
<p>Frequency analysis has been applied to soft shadows [Egan et al. 2011], motion blur [Egan et al. 2009], and depth of field [Soler et al. 2009]. We build on this tradition but discover that bandwidth is a poor predictor for our application.</p>

<hr>

<h2>3. Method</h2>

<h3>3.1 Ray Skipping</h3>

<div class="key-result">
    <strong>Key insight:</strong> ARC skips angular directions within each probe, not entire probes. For a probe with 64 directions, a 2× skip means tracing only 32 directions and copying results to neighbors.
</div>

<figure>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <style>
    text { font-family: 'Segoe UI', Arial, sans-serif; }
    .title { font-size: 16px; font-weight: bold; fill: #333; }
    .subtitle { font-size: 13px; fill: #555; }
    .label { font-size: 12px; fill: #555; }
    .small { font-size: 10px; fill: #666; }
  </style>
  <rect width="800" height="500" fill="#fafafa"/>
  <text x="400" y="30" text-anchor="middle" class="title">Figure 1: ARC Ray Skipping - Angular Directions Within a Probe</text>
  <g transform="translate(150, 250)">
    <text x="0" y="-140" text-anchor="middle" class="subtitle">Standard Radiance Cascades</text>
    <text x="0" y="-120" text-anchor="middle" class="small">All 16 angular directions traced</text>
    <circle cx="0" cy="0" r="8" fill="#333"/>
    <g stroke="#4a90d9" stroke-width="2">
      <line x1="0" y1="0" x2="0" y2="-90"/><line x1="0" y1="0" x2="35" y2="-83"/>
      <line x1="0" y1="0" x2="64" y2="-64"/><line x1="0" y1="0" x2="83" y2="-35"/>
      <line x1="0" y1="0" x2="90" y2="0"/><line x1="0" y1="0" x2="83" y2="35"/>
      <line x1="0" y1="0" x2="64" y2="64"/><line x1="0" y1="0" x2="35" y2="83"/>
      <line x1="0" y1="0" x2="0" y2="90"/><line x1="0" y1="0" x2="-35" y2="83"/>
      <line x1="0" y1="0" x2="-64" y2="64"/><line x1="0" y1="0" x2="-83" y2="35"/>
      <line x1="0" y1="0" x2="-90" y2="0"/><line x1="0" y1="0" x2="-83" y2="-35"/>
      <line x1="0" y1="0" x2="-64" y2="-64"/><line x1="0" y1="0" x2="-35" y2="-83"/>
    </g>
    <g fill="#4a90d9">
      <circle cx="0" cy="-90" r="4"/><circle cx="35" cy="-83" r="4"/><circle cx="64" cy="-64" r="4"/><circle cx="83" cy="-35" r="4"/>
      <circle cx="90" cy="0" r="4"/><circle cx="83" cy="35" r="4"/><circle cx="64" cy="64" r="4"/><circle cx="35" cy="83" r="4"/>
      <circle cx="0" cy="90" r="4"/><circle cx="-35" cy="83" r="4"/><circle cx="-64" cy="64" r="4"/><circle cx="-83" cy="35" r="4"/>
      <circle cx="-90" cy="0" r="4"/><circle cx="-83" cy="-35" r="4"/><circle cx="-64" cy="-64" r="4"/><circle cx="-35" cy="-83" r="4"/>
    </g>
    <text x="0" y="120" text-anchor="middle" class="label">16 rays traced</text>
  </g>
  <g transform="translate(340, 250)">
    <path d="M0,0 L60,0" stroke="#333" stroke-width="2" marker-end="url(#arr1)"/>
    <text x="30" y="-10" text-anchor="middle" class="small">2× skip</text>
  </g>
  <g transform="translate(500, 250)">
    <text x="0" y="-140" text-anchor="middle" class="subtitle">With ARC (2× skip)</text>
    <text x="0" y="-120" text-anchor="middle" class="small">8 directions traced, 8 copied</text>
    <circle cx="0" cy="0" r="8" fill="#333"/>
    <g stroke="#4a90d9" stroke-width="2">
      <line x1="0" y1="0" x2="0" y2="-90"/><line x1="0" y1="0" x2="64" y2="-64"/>
      <line x1="0" y1="0" x2="90" y2="0"/><line x1="0" y1="0" x2="64" y2="64"/>
      <line x1="0" y1="0" x2="0" y2="90"/><line x1="0" y1="0" x2="-64" y2="64"/>
      <line x1="0" y1="0" x2="-90" y2="0"/><line x1="0" y1="0" x2="-64" y2="-64"/>
    </g>
    <g stroke="#4a90d9" stroke-width="1.5" stroke-dasharray="4,4" opacity="0.4">
      <line x1="0" y1="0" x2="35" y2="-83"/><line x1="0" y1="0" x2="83" y2="-35"/>
      <line x1="0" y1="0" x2="83" y2="35"/><line x1="0" y1="0" x2="35" y2="83"/>
      <line x1="0" y1="0" x2="-35" y2="83"/><line x1="0" y1="0" x2="-83" y2="35"/>
      <line x1="0" y1="0" x2="-83" y2="-35"/><line x1="0" y1="0" x2="-35" y2="-83"/>
    </g>
    <g fill="#4a90d9">
      <circle cx="0" cy="-90" r="4"/><circle cx="64" cy="-64" r="4"/><circle cx="90" cy="0" r="4"/><circle cx="64" cy="64" r="4"/>
      <circle cx="0" cy="90" r="4"/><circle cx="-64" cy="64" r="4"/><circle cx="-90" cy="0" r="4"/><circle cx="-64" cy="-64" r="4"/>
    </g>
    <g fill="#4a90d9" opacity="0.4">
      <circle cx="35" cy="-83" r="4"/><circle cx="83" cy="-35" r="4"/><circle cx="83" cy="35" r="4"/><circle cx="35" cy="83" r="4"/>
      <circle cx="-35" cy="83" r="4"/><circle cx="-83" cy="35" r="4"/><circle cx="-83" cy="-35" r="4"/><circle cx="-35" cy="-83" r="4"/>
    </g>
    <text x="0" y="120" text-anchor="middle" class="label">8 rays traced, 8 copied</text>
    <text x="0" y="135" text-anchor="middle" class="small" fill="#27ae60">50% ray reduction at this level</text>
  </g>
  <g transform="translate(100, 420)">
    <rect x="0" y="-20" width="600" height="80" fill="#f5f5f5" rx="5" stroke="#ddd"/>
    <text x="300" y="0" text-anchor="middle" class="label" font-weight="bold">Skip Patterns by Mode</text>
    <text x="20" y="25" class="small" font-weight="bold">Mode</text>
    <text x="100" y="25" class="small">L0-L2</text>
    <text x="170" y="25" class="small">L3</text>
    <text x="230" y="25" class="small">L4</text>
    <text x="290" y="25" class="small">L5</text>
    <text x="380" y="25" class="small">Reduction</text>
    <text x="20" y="42" class="small">L5</text><text x="100" y="42" class="small">1×</text><text x="170" y="42" class="small">1×</text><text x="230" y="42" class="small">2×</text><text x="290" y="42" class="small">4×</text><text x="380" y="42" class="small" fill="#27ae60">~10%</text>
    <text x="20" y="56" class="small">L4</text><text x="100" y="56" class="small">1×</text><text x="170" y="56" class="small">2×</text><text x="230" y="56" class="small">2×</text><text x="290" y="56" class="small">2×</text><text x="380" y="56" class="small" fill="#3498db">~17%</text>
    <text x="500" y="42" class="small">1× = all rays</text>
    <text x="500" y="56" class="small">4× = every 4th ray</text>
  </g>
  <defs><marker id="arr1" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#333"/></marker></defs>
</svg>
<figcaption>Figure 1: ARC skips angular directions within each probe. Solid lines are traced; dashed lines are copied.</figcaption>
</figure>

<h3>3.2 The Bandwidth Paradox</h3>

<p>Our initial hypothesis: <strong>bandwidth should positively correlate with required sample density</strong>—high-frequency content needs more samples (Nyquist reasoning).</p>

<div class="discovery-box">
    <strong>We were wrong.</strong> Our 50-scene benchmark revealed bandwidth correlates <strong>significantly negatively</strong> (r = -0.68, 95% CI [-0.81, -0.50], p < 0.05) with quality tolerance!
</div>

<figure>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400">
  <style>
    text { font-family: 'Segoe UI', Arial, sans-serif; }
    .title { font-size: 16px; font-weight: bold; fill: #333; }
    .subtitle { font-size: 13px; fill: #555; }
    .label { font-size: 12px; fill: #555; }
    .value { font-size: 11px; fill: #333; }
    .axis { font-size: 10px; fill: #666; }
  </style>
  <rect width="800" height="400" fill="#fafafa"/>
  <text x="400" y="30" text-anchor="middle" class="title">Figure 2: The Bandwidth Paradox</text>
  <g transform="translate(50, 70)">
    <rect x="0" y="0" width="300" height="280" fill="#fff" rx="10" stroke="#e74c3c" stroke-width="2"/>
    <text x="150" y="25" text-anchor="middle" class="subtitle" fill="#e74c3c">Simple Scene (1-2 Lights)</text>
    <g transform="translate(30, 50)">
      <rect x="0" y="0" width="240" height="100" fill="#1a1a2e"/>
      <circle cx="60" cy="50" r="15" fill="#fff9c4"/>
      <path d="M60,50 L20,100 L100,100 Z" fill="rgba(255,249,196,0.3)"/>
    </g>
    <g transform="translate(30, 170)">
      <text x="120" y="0" text-anchor="middle" class="axis">Angular Radiance Distribution</text>
      <rect x="0" y="10" width="240" height="60" fill="#f5f5f5" stroke="#ddd"/>
      <path d="M20,65 L60,65 L70,20 L80,65 L220,65" fill="none" stroke="#e74c3c" stroke-width="2"/>
      <text x="120" y="85" text-anchor="middle" class="axis" fill="#e74c3c">Sharp peak = HIGH frequency</text>
    </g>
    <g transform="translate(30, 250)">
      <text x="0" y="0" class="value">Bandwidth: <tspan fill="#e74c3c" font-weight="bold">HIGH</tspan></text>
      <text x="0" y="18" class="value">Quality: <tspan fill="#e74c3c" font-weight="bold">SENSITIVE</tspan> to skipping</text>
    </g>
  </g>
  <g transform="translate(450, 70)">
    <rect x="0" y="0" width="300" height="280" fill="#fff" rx="10" stroke="#27ae60" stroke-width="2"/>
    <text x="150" y="25" text-anchor="middle" class="subtitle" fill="#27ae60">Complex Scene (50 Lights)</text>
    <g transform="translate(30, 50)">
      <rect x="0" y="0" width="240" height="100" fill="#2d3436"/>
      <circle cx="30" cy="30" r="8" fill="#fff9c4" opacity="0.7"/><circle cx="70" cy="50" r="8" fill="#fff9c4" opacity="0.7"/>
      <circle cx="110" cy="25" r="8" fill="#fff9c4" opacity="0.7"/><circle cx="150" cy="60" r="8" fill="#fff9c4" opacity="0.7"/>
      <circle cx="190" cy="35" r="8" fill="#fff9c4" opacity="0.7"/><circle cx="220" cy="70" r="8" fill="#fff9c4" opacity="0.7"/>
      <circle cx="50" cy="80" r="8" fill="#fff9c4" opacity="0.7"/><circle cx="130" cy="85" r="8" fill="#fff9c4" opacity="0.7"/>
      <rect x="0" y="70" width="240" height="30" fill="rgba(255,249,196,0.2)"/>
    </g>
    <g transform="translate(30, 170)">
      <text x="120" y="0" text-anchor="middle" class="axis">Angular Radiance Distribution</text>
      <rect x="0" y="10" width="240" height="60" fill="#f5f5f5" stroke="#ddd"/>
      <path d="M20,55 Q60,40 120,35 Q180,40 220,55" fill="none" stroke="#27ae60" stroke-width="2"/>
      <text x="120" y="85" text-anchor="middle" class="axis" fill="#27ae60">Smooth curve = LOW frequency</text>
    </g>
    <g transform="translate(30, 250)">
      <text x="0" y="0" class="value">Bandwidth: <tspan fill="#27ae60" font-weight="bold">LOW</tspan></text>
      <text x="0" y="18" class="value">Quality: <tspan fill="#27ae60" font-weight="bold">ROBUST</tspan> to skipping</text>
    </g>
  </g>
  <g transform="translate(50, 370)">
    <rect x="0" y="-10" width="700" height="35" fill="#fff3e0" rx="5"/>
    <text x="350" y="10" text-anchor="middle" class="label"><tspan font-weight="bold">Key Insight:</tspan> Bandwidth measures sparsity, not complexity.</text>
    <text x="350" y="25" text-anchor="middle" class="axis">Simple scenes = sharp peaks (high BW). Complex scenes = smooth overlap (low BW).</text>
  </g>
</svg>
<figcaption>Figure 2: Simple scenes have sharp peaks (high bandwidth); complex scenes have smooth distributions (low bandwidth).</figcaption>
</figure>

<h3>3.3 Finding the Right Signal</h3>

<table>
    <tr><th>Signal</th><th>r</th><th>95% CI</th><th>Significant?</th></tr>
    <tr><td>Light Count</td><td>0.81</td><td>[0.69, 0.89]</td><td>✅ (ground truth)</td></tr>
    <tr><td>Mean</td><td>0.77</td><td>[0.62, 0.86]</td><td>✅</td></tr>
    <tr class="highlight-row"><td><strong>Mean + StdDev</strong></td><td><strong>0.73</strong></td><td><strong>[0.56, 0.84]</strong></td><td>✅ <strong>Best measurable</strong></td></tr>
    <tr><td>StdDev</td><td>0.69</td><td>[0.50, 0.81]</td><td>✅</td></tr>
    <tr><td>Non-Zero Ratio</td><td>0.20</td><td>[-0.08, 0.45]</td><td>❌ (crosses 0)</td></tr>
    <tr><td>Peak/Average</td><td>-0.60</td><td>[-0.75, -0.39]</td><td>✅ (wrong direction)</td></tr>
    <tr><td class="danger"><strong>90% Bandwidth</strong></td><td class="danger"><strong>-0.68</strong></td><td class="danger"><strong>[-0.81, -0.50]</strong></td><td class="danger">✅ <strong>Significantly negative!</strong></td></tr>
</table>

<figure>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 750 500">
  <style>
    text { font-family: 'Segoe UI', Arial, sans-serif; }
    .title { font-size: 16px; font-weight: bold; fill: #333; }
    .label { font-size: 12px; fill: #555; }
    .value { font-size: 11px; fill: #333; }
    .axis { font-size: 10px; fill: #666; }
    .ci { font-size: 9px; fill: #888; }
  </style>
  <rect width="750" height="500" fill="#fafafa"/>
  <text x="375" y="30" text-anchor="middle" class="title">Figure 3: Signal Correlation with L2 PSNR (n=50, 95% CI)</text>
  <g transform="translate(180, 70)">
    <line x1="0" y1="0" x2="0" y2="300" stroke="#333" stroke-width="1"/>
    <line x1="0" y1="150" x2="440" y2="150" stroke="#999" stroke-width="1" stroke-dasharray="3,3"/>
    <text x="-10" y="5" text-anchor="end" class="axis">+1.0</text>
    <text x="-10" y="80" text-anchor="end" class="axis">+0.5</text>
    <text x="-10" y="155" text-anchor="end" class="axis">0.0</text>
    <text x="-10" y="230" text-anchor="end" class="axis">-0.5</text>
    <text x="-10" y="305" text-anchor="end" class="axis">-1.0</text>
    <text x="-60" y="150" text-anchor="middle" class="label" transform="rotate(-90, -60, 150)">Correlation with L2 PSNR</text>
    <g transform="translate(25, 0)">
      <rect x="-15" y="28.5" width="30" height="121.5" fill="#95a5a6"/>
      <line x1="0" y1="46.5" x2="0" y2="16.5" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="46.5" x2="5" y2="46.5" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="16.5" x2="5" y2="16.5" stroke="#333" stroke-width="2"/>
      <text x="0" y="330" text-anchor="middle" class="axis">Light</text>
      <text x="0" y="342" text-anchor="middle" class="axis">Count</text>
      <text x="0" y="10" text-anchor="middle" class="value" fill="#95a5a6">0.81</text>
    </g>
    <g transform="translate(85, 0)">
      <rect x="-15" y="40.5" width="30" height="109.5" fill="#27ae60"/>
      <line x1="0" y1="66" x2="0" y2="24" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="66" x2="5" y2="66" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="24" x2="5" y2="24" stroke="#333" stroke-width="2"/>
      <text x="0" y="330" text-anchor="middle" class="axis">Mean+</text>
      <text x="0" y="342" text-anchor="middle" class="axis">StdDev</text>
      <text x="0" y="34" text-anchor="middle" class="value" fill="#27ae60" font-weight="bold">0.73 ✓</text>
    </g>
    <g transform="translate(145, 0)">
      <rect x="-15" y="34.5" width="30" height="115.5" fill="#3498db"/>
      <line x1="0" y1="57" x2="0" y2="21" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="57" x2="5" y2="57" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="21" x2="5" y2="21" stroke="#333" stroke-width="2"/>
      <text x="0" y="330" text-anchor="middle" class="axis">Mean</text>
      <text x="0" y="28" text-anchor="middle" class="value" fill="#3498db">0.77</text>
    </g>
    <g transform="translate(205, 0)">
      <rect x="-15" y="46.5" width="30" height="103.5" fill="#3498db"/>
      <line x1="0" y1="75" x2="0" y2="28.5" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="75" x2="5" y2="75" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="28.5" x2="5" y2="28.5" stroke="#333" stroke-width="2"/>
      <text x="0" y="330" text-anchor="middle" class="axis">StdDev</text>
      <text x="0" y="40" text-anchor="middle" class="value" fill="#3498db">0.69</text>
    </g>
    <g transform="translate(265, 0)">
      <rect x="-15" y="120" width="30" height="30" fill="#f39c12"/>
      <line x1="0" y1="162" x2="0" y2="82.5" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="162" x2="5" y2="162" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="82.5" x2="5" y2="82.5" stroke="#333" stroke-width="2"/>
      <text x="0" y="330" text-anchor="middle" class="axis">Non-</text>
      <text x="0" y="342" text-anchor="middle" class="axis">Zero</text>
      <text x="0" y="115" text-anchor="middle" class="value" fill="#f39c12">0.20</text>
    </g>
    <g transform="translate(325, 0)">
      <rect x="-15" y="150" width="30" height="90" fill="#e67e22"/>
      <line x1="0" y1="262.5" x2="0" y2="208.5" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="262.5" x2="5" y2="262.5" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="208.5" x2="5" y2="208.5" stroke="#333" stroke-width="2"/>
      <text x="0" y="330" text-anchor="middle" class="axis">Peak/</text>
      <text x="0" y="342" text-anchor="middle" class="axis">Avg</text>
      <text x="0" y="252" text-anchor="middle" class="value" fill="#e67e22">-0.60</text>
    </g>
    <g transform="translate(385, 0)">
      <rect x="-15" y="150" width="30" height="102" fill="#e74c3c"/>
      <line x1="0" y1="271.5" x2="0" y2="225" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="271.5" x2="5" y2="271.5" stroke="#333" stroke-width="2"/>
      <line x1="-5" y1="225" x2="5" y2="225" stroke="#333" stroke-width="2"/>
      <text x="0" y="330" text-anchor="middle" class="axis">BW90</text>
      <text x="0" y="264" text-anchor="middle" class="value" fill="#e74c3c" font-weight="bold">-0.68 ✗</text>
    </g>
  </g>
  <g transform="translate(550, 100)">
    <rect x="0" y="0" width="170" height="100" fill="#e8f8e8" rx="5" stroke="#27ae60"/>
    <text x="85" y="22" text-anchor="middle" class="label" fill="#27ae60" font-weight="bold">Best Signal:</text>
    <text x="85" y="42" text-anchor="middle" class="value">Mean + StdDev</text>
    <text x="85" y="60" text-anchor="middle" class="value">r = 0.73</text>
    <text x="85" y="80" text-anchor="middle" class="axis" fill="#27ae60">p &lt; 0.05 ✓</text>
  </g>
  <g transform="translate(550, 220)">
    <rect x="0" y="0" width="170" height="100" fill="#fde8e8" rx="5" stroke="#e74c3c"/>
    <text x="85" y="22" text-anchor="middle" class="label" fill="#e74c3c" font-weight="bold">Worst Signal:</text>
    <text x="85" y="42" text-anchor="middle" class="value">90% Bandwidth</text>
    <text x="85" y="60" text-anchor="middle" class="value">r = -0.68</text>
    <text x="85" y="80" text-anchor="middle" class="axis" fill="#e74c3c">Significantly negative!</text>
  </g>
  <text x="375" y="440" text-anchor="middle" class="axis">Error bars show 95% confidence intervals</text>
  <text x="375" y="455" text-anchor="middle" class="axis">CI not crossing zero = statistically significant (p &lt; 0.05)</text>
</svg>
<figcaption>Figure 3: Correlation analysis with 95% confidence intervals. Mean+StdDev is significantly positive; BW90 is significantly negative.</figcaption>
</figure>

<h3>3.4 Adaptive Algorithm</h3>

<pre><code><span class="function">ADAPTIVE_LEVEL_SELECT</span>():
    <span class="comment">// Sample L1 cascade at ~8 probe locations</span>
    <span class="keyword">for each</span> probe:
        samples ← get_angular_radiance(probe)
        mean_sum += average(samples)
        stddev_sum += standard_deviation(samples)
    
    score ← (mean_sum + stddev_sum) / num_probes
    
    <span class="comment">// Thresholds calibrated for >50 dB guarantee</span>
    <span class="keyword">if</span> score < <span class="number">0.45</span>:
        <span class="keyword">return</span> L5   <span class="comment">// ~10% reduction</span>
    <span class="keyword">else if</span> score < <span class="number">1.00</span>:
        <span class="keyword">return</span> L4   <span class="comment">// ~17% reduction</span>
    <span class="keyword">else</span>:
        <span class="keyword">return</span> L3   <span class="comment">// ~25% reduction</span></code></pre>

<hr>

<h2>4. Results</h2>

<h3>4.1 Test Configuration</h3>
<ul>
    <li><strong>Platform:</strong> WebGPU, 512×512 resolution</li>
    <li><strong>Scenes:</strong> 50 configurations (1-50 lights, 1-8 occluders)</li>
    <li><strong>Metric:</strong> PSNR vs. ARC-OFF baseline (>50 dB = visually identical)</li>
</ul>

<h3>4.2 Results Summary</h3>

<table>
    <tr><th>Mode</th><th>Reduction</th><th>PSNR Range</th><th>Avg PSNR</th><th>All >50dB?</th></tr>
    <tr><td>L5</td><td>~10%</td><td>56.7 - 67.6 dB</td><td>61.8 dB</td><td class="success">✅ Yes</td></tr>
    <tr><td>L4</td><td>~17%</td><td>49.9 - 60.6 dB</td><td>55.2 dB</td><td class="danger">❌ No</td></tr>
    <tr><td>L3</td><td>~25%</td><td>47.3 - 59.5 dB</td><td>53.7 dB</td><td class="danger">❌ No</td></tr>
    <tr><td>L2</td><td>~40%</td><td>35.9 - 52.0 dB</td><td>43.6 dB</td><td class="danger">❌ No</td></tr>
    <tr class="highlight-row"><td><strong>Adaptive</strong></td><td><strong>~19%</strong></td><td><strong>>50 dB</strong></td><td><strong>~55 dB</strong></td><td class="success"><strong>✅ Yes (100%)</strong></td></tr>
</table>

<figure>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 350">
  <style>
    text { font-family: 'Segoe UI', Arial, sans-serif; }
    .title { font-size: 16px; font-weight: bold; fill: #333; }
    .subtitle { font-size: 13px; fill: #555; }
    .label { font-size: 12px; fill: #555; }
    .value { font-size: 11px; fill: #333; }
    .big { font-size: 28px; font-weight: bold; }
    .axis { font-size: 10px; fill: #666; }
  </style>
  <rect width="800" height="350" fill="#fafafa"/>
  <text x="400" y="30" text-anchor="middle" class="title">Figure 4: Adaptive Mode Results (50-Scene Benchmark)</text>
  <g transform="translate(40, 60)">
    <rect x="0" y="0" width="140" height="90" fill="#f5f5f5" rx="10" stroke="#999" stroke-width="2"/>
    <text x="70" y="30" text-anchor="middle" class="label">Sample Size</text>
    <text x="70" y="65" text-anchor="middle" class="big" fill="#333">n=50</text>
    <text x="70" y="82" text-anchor="middle" class="axis">scenes</text>
    <rect x="160" y="0" width="140" height="90" fill="#e8f4fd" rx="10" stroke="#3498db" stroke-width="2"/>
    <text x="230" y="30" text-anchor="middle" class="label">Ray Reduction</text>
    <text x="230" y="65" text-anchor="middle" class="big" fill="#3498db">~19%</text>
    <text x="230" y="82" text-anchor="middle" class="axis">average</text>
    <rect x="320" y="0" width="140" height="90" fill="#e8f8e8" rx="10" stroke="#27ae60" stroke-width="2"/>
    <text x="390" y="30" text-anchor="middle" class="label">Quality</text>
    <text x="390" y="65" text-anchor="middle" class="big" fill="#27ae60">>50dB</text>
    <text x="390" y="82" text-anchor="middle" class="axis">all scenes ✓</text>
    <rect x="480" y="0" width="140" height="90" fill="#f0e8f8" rx="10" stroke="#9b59b6" stroke-width="2"/>
    <text x="550" y="30" text-anchor="middle" class="label">Confidence</text>
    <text x="550" y="65" text-anchor="middle" class="big" fill="#9b59b6">95%</text>
    <text x="550" y="82" text-anchor="middle" class="axis">CI validated</text>
    <rect x="640" y="0" width="120" height="90" fill="#fef8e8" rx="10" stroke="#f39c12" stroke-width="2"/>
    <text x="700" y="30" text-anchor="middle" class="label">Code</text>
    <text x="700" y="65" text-anchor="middle" class="big" fill="#f39c12">~10</text>
    <text x="700" y="82" text-anchor="middle" class="axis">lines WGSL</text>
  </g>
  <g transform="translate(40, 180)">
    <text x="360" y="0" text-anchor="middle" class="subtitle">Mode Comparison</text>
    <rect x="0" y="15" width="720" height="130" fill="#fff" rx="5" stroke="#ddd"/>
    <text x="80" y="40" text-anchor="middle" class="label" font-weight="bold">Mode</text>
    <text x="200" y="40" text-anchor="middle" class="label" font-weight="bold">Reduction</text>
    <text x="340" y="40" text-anchor="middle" class="label" font-weight="bold">PSNR Range</text>
    <text x="480" y="40" text-anchor="middle" class="label" font-weight="bold">Avg</text>
    <text x="620" y="40" text-anchor="middle" class="label" font-weight="bold">All >50dB?</text>
    <line x1="20" y1="50" x2="700" y2="50" stroke="#ddd"/>
    <text x="80" y="70" text-anchor="middle" class="value">L5</text><text x="200" y="70" text-anchor="middle" class="value">~10%</text><text x="340" y="70" text-anchor="middle" class="value">56.7 - 67.6</text><text x="480" y="70" text-anchor="middle" class="value">61.8</text><text x="620" y="70" text-anchor="middle" class="value" fill="#27ae60">✅</text>
    <text x="80" y="90" text-anchor="middle" class="value">L4</text><text x="200" y="90" text-anchor="middle" class="value">~17%</text><text x="340" y="90" text-anchor="middle" class="value">49.9 - 60.6</text><text x="480" y="90" text-anchor="middle" class="value">55.2</text><text x="620" y="90" text-anchor="middle" class="value" fill="#e74c3c">❌</text>
    <text x="80" y="110" text-anchor="middle" class="value">L3</text><text x="200" y="110" text-anchor="middle" class="value">~25%</text><text x="340" y="110" text-anchor="middle" class="value">47.3 - 59.5</text><text x="480" y="110" text-anchor="middle" class="value">53.7</text><text x="620" y="110" text-anchor="middle" class="value" fill="#e74c3c">❌</text>
    <line x1="20" y1="120" x2="700" y2="120" stroke="#27ae60" stroke-width="2"/>
    <rect x="25" y="123" width="670" height="22" fill="#e8f8e8" rx="3"/>
    <text x="80" y="138" text-anchor="middle" class="value" fill="#27ae60" font-weight="bold">Adaptive</text>
    <text x="200" y="138" text-anchor="middle" class="value" fill="#27ae60" font-weight="bold">~19%</text>
    <text x="340" y="138" text-anchor="middle" class="value" fill="#27ae60" font-weight="bold">>50 dB guaranteed</text>
    <text x="480" y="138" text-anchor="middle" class="value" fill="#27ae60" font-weight="bold">~55</text>
    <text x="620" y="138" text-anchor="middle" class="value" fill="#27ae60" font-weight="bold">✅ 100%</text>
  </g>
  <text x="400" y="335" text-anchor="middle" class="axis">Thresholds: score &lt; 0.45 → L5, score &lt; 1.00 → L4, score ≥ 1.00 → L3</text>
</svg>
<figcaption>Figure 4: Summary of results. Adaptive mode achieves ~19% ray reduction with 100% quality guarantee.</figcaption>
</figure>

<hr>

<h2>5. Implementation</h2>

<pre><code><span class="comment">// WGSL Shader (~10 lines)</span>
<span class="keyword">fn</span> <span class="function">arcStep</span>(level: i32) -> i32 {
    <span class="keyword">if</span> (u.arcEnabled == <span class="number">0u</span>) { <span class="keyword">return</span> <span class="number">1</span>; }
    <span class="keyword">let</span> startLevel = i32(u.arcStartLevel);
    <span class="keyword">let</span> maxSkipBits = i32(u.arcMaxSkip);
    <span class="keyword">if</span> (level < startLevel) { <span class="keyword">return</span> <span class="number">1</span>; }
    <span class="keyword">return</span> <span class="number">1</span> << u32(min(level - startLevel + <span class="number">1</span>, maxSkipBits));
}

<span class="comment">// In cascade merge loop:</span>
<span class="keyword">let</span> step = arcStep(level);
<span class="keyword">for</span> (<span class="keyword">var</span> d = <span class="number">0</span>; d < numDirs; d += step) {
    <span class="comment">// trace ray, write to d through d+step-1</span>
}</code></pre>

<hr>

<h2>6. Discussion</h2>

<h3>6.1 Why Bandwidth Failed</h3>
<p><strong>Simple scenes</strong> produce <em>sparse</em> angular distributions with sharp peaks → high frequency (high BW) → sensitive to skipping.</p>
<p><strong>Complex scenes</strong> produce <em>dense</em> distributions with overlapping light → smooth gradients (low BW) → robust to skipping.</p>
<p>Bandwidth measures <strong>sparsity</strong>, not complexity. This doesn't contradict Nyquist—it reveals that bandwidth predicts the <em>wrong property</em> for our application.</p>

<h3>6.2 Limitations</h3>
<ol>
    <li><strong>2D validation:</strong> 3D production scenes should be tested</li>
    <li><strong>Threshold generality:</strong> Different contexts may need recalibration</li>
    <li><strong>Trade-off:</strong> To guarantee quality, we use ~19% vs potential ~25%</li>
</ol>

<hr>

<h2>7. Conclusion</h2>

<div class="key-result">
    <strong>Key findings:</strong>
    <ol>
        <li>Higher cascade levels are oversampled relative to actual frequency content</li>
        <li><strong>Bandwidth is significantly negatively correlated</strong> (r = -0.68, p < 0.05)</li>
        <li><strong>Mean + StdDev</strong> is a statistically validated signal (r = 0.73, p < 0.05)</li>
        <li>Adaptive mode: <strong>~19% ray reduction with 100% quality guarantee</strong></li>
    </ol>
</div>

<p>The technique is simple (~10 lines), preserves algorithm properties, and adapts automatically with statistical confidence.</p>

<hr>

<h2>References</h2>
<div class="references">
    <p>Egan, K., et al. 2009. Frequency analysis and sheared reconstruction for rendering motion blur. <em>ACM Trans. Graph.</em> 28, 3.</p>
    <p>Egan, K., et al. 2011. Frequency analysis and sheared filtering for shadow light fields. <em>ACM Trans. Graph.</em> 30, 2.</p>
    <p>Keller, A., et al. 2015. The path tracing revolution in the movie industry. <em>ACM SIGGRAPH Courses</em>.</p>
    <p>McGuire, M., et al. 2017. Real-time global illumination using precomputed light field probes. <em>I3D</em>.</p>
    <p>Mitchell, D. P. 1987. Generating antialiased images at low sampling densities. <em>ACM SIGGRAPH</em>.</p>
    <p>Müller, T., et al. 2019. Neural importance sampling. <em>ACM Trans. Graph.</em> 38, 5.</p>
    <p>Sannikov, A. 2023. Radiance Cascades. <a href="https://drive.google.com/file/d/1L6v1_7HY2X-LV3Ofb6oyTIxgEaP4LOI6">Technical Report</a>.</p>
    <p>Soler, C., et al. 2009. Fourier depth of field. <em>ACM Trans. Graph.</em> 28, 2.</p>
    <p>Whitted, T. 1980. An improved illumination model for shaded display. <em>CACM</em> 23, 6.</p>
</div>

<footer>
    © 2025 Emmanuel Botros Youssef. Licensed under CC BY 4.0.
</footer>

</body>
</html>
